(()=>{"use strict";var e={38:(e,t,o)=>{e.exports=o.p+"img/angry.6072db63.svg"},89:(e,t,o)=>{e.exports=o.p+"img/sad.b9177e27.svg"},219:(e,t,o)=>{e.exports=o.p+"img/tired.99a71eb9.svg"},478:(e,t,o)=>{e.exports=o.p+"img/calm.29415193.svg"},527:(e,t,o)=>{e.exports=o.p+"img/happy.d7c8e5f4.svg"},842:(e,t,o)=>{e.exports=o.p+"img/anxious.2a350247.svg"},939:(e,t,o)=>{var n=o(751),r=o(641),a=o(33);const i={key:2,class:"content"};function s(e,t,o,n,s,c){const m=(0,r.g2)("LoadingScreen"),l=(0,r.g2)("EmotionSelect");return(0,r.uX)(),(0,r.CE)("div",{id:"app",class:(0,a.C4)({"telegram-app":s.isTelegramWebApp})},["loading"===s.currentScreen?((0,r.uX)(),(0,r.Wv)(m,{key:0})):"emotion"===s.currentScreen?((0,r.uX)(),(0,r.Wv)(l,{key:1,onEmotionSelected:c.handleEmotionSelect},null,8,["onEmotionSelected"])):((0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("p",null,"Выбранная эмоция: "+(0,a.v_)(s.selectedEmotion),1)]))],2)}const c=o.p+"img/logo.2ea0a334.png",m={class:"loading-screen"};function l(e,t,o,n,a,i){return(0,r.uX)(),(0,r.CE)("div",m,t[0]||(t[0]=[(0,r.Lk)("div",{class:"loading-content"},[(0,r.Lk)("img",{src:c,alt:"Logo",class:"logo"}),(0,r.Lk)("p",{class:"loading-text"},"Загрузка...")],-1)]))}const d={name:"LoadingScreen"};var p=o(262);const g=(0,p.A)(d,[["render",l],["__scopeId","data-v-0864ef82"]]),u=g,h={class:"emotion-select"},v={class:"glass-container"},f={class:"emotions-grid"},y=["onClick"],w=["src","alt"],E={class:"emotion-name"};function b(e,t,o,n,i,s){return(0,r.uX)(),(0,r.CE)("div",h,[t[0]||(t[0]=(0,r.Lk)("h1",{class:"title"},"Как ты себя чувствуешь?",-1)),(0,r.Lk)("div",v,[(0,r.Lk)("div",f,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.emotions,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"emotion-item",onClick:t=>s.selectEmotion(e.id)},[(0,r.Lk)("img",{src:e.icon,alt:e.name},null,8,w),(0,r.Lk)("span",E,(0,a.v_)(e.name),1)],8,y)))),128))])])])}var k=o(884),I=o(223);const S={apiKey:"AIzaSyA45HVlArfrCX12RzClqX8yvPWQDjx97iM",authDomain:"iki-nowels.firebaseapp.com",projectId:"iki-nowels",storageBucket:"iki-nowels.firebasestorage.app",messagingSenderId:"1064173724655",appId:"1:1064173724655:web:7292b8b03bf0fe7708cc1a",measurementId:"G-MZD8G11D0Y"},C=(0,I.Wp)(S),O=(0,k.aU)(C),T="https://ikiteam.ru/api",x={async saveUser(e){try{const t=await fetch(`${T}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:e})});return t.json()}catch(t){throw console.error("Error saving user:",t),t}},async saveEmotion(e,t){try{const o=await fetch(`${T}/emotions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:e,emotion:t.emotion,timestamp:t.timestamp})});return o.json()}catch(o){throw console.error("Error saving emotion:",o),o}},async getUserEmotions(e,t,o){try{const n=await fetch(`${T}/emotions?telegramId=${e}&startDate=${t}&endDate=${o}`);return n.json()}catch(n){throw console.error("Error getting emotions:",n),n}}},j=window.Telegram?.WebApp,A=()=>Boolean(window.Telegram?.WebApp),D=()=>j?.initDataUnsafe?.user?.id,L=()=>{j&&(j.ready(),j.expand())},_={name:"EmotionSelect",data(){return{telegramId:null,emotions:[{id:1,name:"Радостно",icon:o(527)},{id:2,name:"Грустно",icon:o(89)},{id:3,name:"Спокойно",icon:o(478)},{id:4,name:"Тревожно",icon:o(842)},{id:5,name:"Раздражённо",icon:o(38)},{id:6,name:"Мечтательно",icon:o(219)}]}},mounted(){this.telegramId=D(),this.telegramId||console.warn("Telegram ID not found")},methods:{async selectEmotion(e){try{if(!this.telegramId)throw new Error("Telegram ID is required");await x.saveUser(this.telegramId),await x.saveEmotion(this.telegramId,{emotion:e,timestamp:new Date}),this.$router.push("/")}catch(t){console.error("Failed to save emotion:",t)}}}},W=(0,p.A)(_,[["render",b],["__scopeId","data-v-5c2f88ea"]]),X=W,M={async saveEmotion(e,t){try{const o=await(0,k.gS)((0,k.rJ)(O,"emotions"),{emotionId:e,timestamp:new Date,telegramId:t});return o.id}catch(o){throw console.error("Error saving emotion:",o),o}},async getEmotions(e,t,o){try{const n=(0,k.P)((0,k.rJ)(O,"emotions"),(0,k._M)("telegramId","==",e),(0,k._M)("timestamp",">=",t),(0,k._M)("timestamp","<=",o)),r=await(0,k.GG)(n);return r.docs.map((e=>({id:e.id,...e.data()})))}catch(n){throw console.error("Error getting emotions:",n),n}}},$={name:"App",components:{LoadingScreen:u,EmotionSelect:X},data(){return{currentScreen:"loading",selectedEmotion:null,emotions:[],isTelegramWebApp:!1}},mounted(){this.isTelegramWebApp=A(),this.isTelegramWebApp&&L(),setTimeout((()=>{this.currentScreen="emotion"}),2e3)},methods:{async handleEmotionSelect(e){this.selectedEmotion=e,this.currentScreen="main"},async loadEmotions(){try{const e=new Date;e.setMonth(e.getMonth()-1);const t=await M.getEmotions(e,new Date);this.emotions=t}catch(e){console.error("Failed to load emotions:",e)}}}},P=(0,p.A)($,[["render",s]]),U=P;(0,n.Ef)(U).mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}o.m=e,(()=>{var e=[];o.O=(t,n,r,a)=>{if(!n){var i=1/0;for(l=0;l<e.length;l++){for(var[n,r,a]=e[l],s=!0,c=0;c<n.length;c++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](n[c])))?n.splice(c--,1):(s=!1,a<i&&(i=a));if(s){e.splice(l--,1);var m=r();void 0!==m&&(t=m)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[n,r,a]}})(),(()=>{o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{o.p="/test/"})(),(()=>{var e={524:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[i,s,c]=n,m=0;if(i.some((t=>0!==e[t]))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(c)var l=c(o)}for(t&&t(n);m<i.length;m++)a=i[m],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(l)},n=self["webpackChunkweb_novels"]=self["webpackChunkweb_novels"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=o.O(void 0,[504],(()=>o(939)));n=o.O(n)})();
//# sourceMappingURL=app.a350c7de.js.map