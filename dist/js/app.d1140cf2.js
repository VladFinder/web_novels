(()=>{"use strict";var e={253:(e,n,t)=>{e.exports=t.p+"img/Раздражение.800c2a94.png"},485:(e,n,t)=>{e.exports=t.p+"img/Тревога.cb2b7443.png"},562:(e,n,t)=>{e.exports=t.p+"img/Радость.225d89ef.png"},644:(e,n,t)=>{e.exports=t.p+"img/Грусть.cba9a168.png"},693:(e,n,t)=>{e.exports=t.p+"img/Спокойно.b1a2b402.png"},815:(e,n,t)=>{e.exports=t.p+"img/Мечтательность.a6e023e0.png"},847:(e,n,t)=>{var r=t(751),o=t(641);const a={id:"app"};function s(e,n,t,r,s,i){const c=(0,o.g2)("LoadingScreen"),l=(0,o.g2)("EmotionSelect"),u=(0,o.g2)("MainScreen"),d=(0,o.g2)("CalendarScreen");return(0,o.uX)(),(0,o.CE)("div",a,["loading"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(c,{key:0})):"emotion"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(l,{key:1,onEmotionSelected:i.handleEmotionSelect},null,8,["onEmotionSelected"])):"main"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(u,{key:2,onOpenSettings:i.openSettings,onOpenCalendar:i.openCalendar},null,8,["onOpenSettings","onOpenCalendar"])):"calendar"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(d,{key:3,onBack:i.backToMain},null,8,["onBack"])):(0,o.Q3)("",!0)])}const i=t.p+"img/logo.2ea0a334.png",c={class:"loading-screen"};function l(e,n,t,r,a,s){return(0,o.uX)(),(0,o.CE)("div",c,n[0]||(n[0]=[(0,o.Lk)("div",{class:"loading-content"},[(0,o.Lk)("img",{src:i,alt:"Logo",class:"logo"}),(0,o.Lk)("p",{class:"loading-text"},"Загрузка...")],-1)]))}const u={name:"LoadingScreen"};var d=t(262);const m=(0,d.A)(u,[["render",l],["__scopeId","data-v-4f683444"]]),h=m;var p=t(33);const g={class:"emotion-select"},v={class:"glass-container"},k={class:"emotions-grid"},b=["onClick"],f=["src","alt"],y={class:"emotion-name"};function S(e,n,t,r,a,s){return(0,o.uX)(),(0,o.CE)("div",g,[n[0]||(n[0]=(0,o.Lk)("h1",{class:"title"},"Как ты себя чувствуешь?",-1)),(0,o.Lk)("div",v,[(0,o.Lk)("div",k,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.emotions,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"emotion-item",onClick:n=>s.selectEmotion(e.id)},[(0,o.Lk)("img",{src:e.icon,alt:e.name},null,8,f),(0,o.Lk)("span",y,(0,p.v_)(e.name),1)],8,b)))),128))])])])}var M=t(223),w=t(884);const C={apiKey:"AIzaSyA45HVlArfrCX12RzClqX8yvPWQDjx97iM",authDomain:"iki-nowels.firebaseapp.com",projectId:"iki-nowels",storageBucket:"iki-nowels.firebasestorage.app",messagingSenderId:"1064173724655",appId:"1:1064173724655:web:7292b8b03bf0fe7708cc1a",measurementId:"G-MZD8G11D0Y"},I=(0,M.Wp)(C),E=(0,w.aU)(I),L="https://ikiteam.ru/api",O={async saveUser(e){try{const n=await fetch(`${L}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:e})});return n.json()}catch(n){throw console.error("Error saving user:",n),n}},async saveEmotion(e,{emotion:n,note:t,timestamp:r}){return fetch(`${L}/emotions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:e,emotion:n,note:t,timestamp:r})})},async getUserEmotions(e,n,t){const r=new URLSearchParams({telegramId:e,startDate:n.toISOString(),endDate:t.toISOString()}),o=await fetch(`${L}/emotions?${r}`);return await o.json()},async getUser(e){const n=await fetch(`${L}/users/${e}`);if(!n.ok)throw new Error("User not found");return await n.json()},async saveEmotion(e,n){await E.collection("users").doc(String(e)).collection("emotions").add(n)}},D=window.Telegram?.WebApp,x=()=>D?.initDataUnsafe?.user?.id,X={name:"EmotionSelect",data(){return{telegramId:null,emotions:[{id:1,name:"Радостно",icon:t(562)},{id:2,name:"Грустно",icon:t(644)},{id:3,name:"Спокойно",icon:t(693)},{id:4,name:"Тревожно",icon:t(485)},{id:5,name:"Раздражённо",icon:t(253)},{id:6,name:"Мечтательно",icon:t(815)}]}},mounted(){this.telegramId=x(),this.telegramId||console.warn("Telegram ID not found")},methods:{async selectEmotion(e){try{const n=x(),t="";console.log("Сохраняю эмоцию:",{telegramId:n,emotion:e,note:t,timestamp:(new Date).toISOString()}),await O.saveEmotion(n,{emotion:e,note:t,timestamp:(new Date).toISOString()}),this.$emit("emotion-selected",e)}catch(n){console.error("Ошибка сохранения эмоции:",n)}}}},_=(0,d.A)(X,[["render",S],["__scopeId","data-v-6dae0534"]]),Y=_,j=t.p+"img/soul.f8a4fa77.png",A={class:"main-screen"},$={key:0,class:"user-login"},T={class:"buttons-row"};function W(e,n,t,r,a,s){return(0,o.uX)(),(0,o.CE)("div",A,[a.username?((0,o.uX)(),(0,o.CE)("div",$," Привет, @"+(0,p.v_)(a.username)+"! ",1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{class:"settings-btn",onClick:n[0]||(n[0]=n=>e.$emit("open-settings"))}),n[3]||(n[3]=(0,o.Lk)("div",{class:"glass-container"},[(0,o.Lk)("span",{class:"soul-text"},[(0,o.eW)(" Ты не ты, когда"),(0,o.Lk)("br"),(0,o.eW)("голоден ")])],-1)),n[4]||(n[4]=(0,o.Lk)("div",{class:"soul-image"},[(0,o.Lk)("img",{src:j,alt:"Soul"})],-1)),(0,o.Lk)("div",T,[(0,o.Lk)("button",{class:"btn calendar",onClick:n[1]||(n[1]=n=>e.$emit("open-calendar"))}," Календарь настроения "),n[2]||(n[2]=(0,o.Lk)("button",{class:"btn stories",disabled:""}," Скоро тут будут истории ",-1))])])}const F={name:"MainScreen",data(){return{username:null}},async mounted(){const e=x();if(e)try{const n=await O.getUser(e);n&&n.login&&(this.username=n.login)}catch(n){console.error("Ошибка получения логина:",n)}}},U=(0,d.A)(F,[["render",W],["__scopeId","data-v-5a4b4d91"]]),B=U,P={class:"calendar-header"},K=["disabled"],N={class:"month-title"},J=["disabled"],Q={class:"calendar-grid"};function z(e,n,t,a,s,i){return(0,o.uX)(),(0,o.CE)("div",{class:"calendar-screen",onClick:n[6]||(n[6]=(...e)=>i.blurInput&&i.blurInput(...e))},[(0,o.Lk)("button",{class:"back-btn",onClick:n[0]||(n[0]=n=>e.$emit("back"))},"Назад"),(0,o.Lk)("div",P,[(0,o.Lk)("button",{class:"nav-btn",onClick:n[1]||(n[1]=(...e)=>i.prevMonth&&i.prevMonth(...e)),disabled:i.isMinMonth},"<",8,K),(0,o.Lk)("span",N,(0,p.v_)(i.monthName)+" "+(0,p.v_)(s.currentYear),1),(0,o.Lk)("button",{class:"nav-btn",onClick:n[2]||(n[2]=(...e)=>i.nextMonth&&i.nextMonth(...e)),disabled:i.isMaxMonth},">",8,J)]),(0,o.Lk)("div",Q,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.weekDays,(e=>((0,o.uX)(),(0,o.CE)("div",{class:"calendar-day calendar-day-header",key:e},(0,p.v_)(e),1)))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.firstDayOfWeek,(e=>((0,o.uX)(),(0,o.CE)("div",{key:"empty-"+e,class:"calendar-day empty"})))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.daysInMonth,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"calendar-day"},(0,p.v_)(e),1)))),128))]),(0,o.Lk)("div",{class:"note-container",onClick:n[5]||(n[5]=(0,r.D$)((()=>{}),["stop"]))},[(0,o.bo)((0,o.Lk)("textarea",{class:"note-input","onUpdate:modelValue":n[3]||(n[3]=e=>s.note=e),placeholder:"Напишешь пару слов о сегодняшнем дне?",rows:"3",ref:"noteInput",onBlur:n[4]||(n[4]=(...e)=>i.onBlur&&i.onBlur(...e))},null,544),[[r.Jo,s.note]])])])}const G=2025,R=5,V=1,q={name:"CalendarScreen",data(){const e=new Date,n=R,t=G,r=e.getMonth(),o=e.getFullYear();return{currentMonth:r,currentYear:o,minMonth:n,minYear:t,weekDays:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],note:"",isInputFocused:!1}},computed:{monthName(){return["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"][this.currentMonth]},daysInMonth(){const e=new Date(this.currentYear,this.currentMonth+1,0).getDate();return this.currentYear===G&&this.currentMonth===R?Array.from({length:e-V+1},((e,n)=>n+V)):Array.from({length:e},((e,n)=>n+1))},firstDayOfWeek(){let e=new Date(this.currentYear,this.currentMonth,this.currentYear===G&&this.currentMonth===R?V:1).getDay();return e=(e+6)%7,e},isMinMonth(){return this.currentYear===this.minYear&&this.currentMonth===this.minMonth},isMaxMonth(){const e=new Date;return this.currentYear===e.getFullYear()&&this.currentMonth===e.getMonth()}},methods:{prevMonth(){this.isMinMonth||(0===this.currentMonth?(this.currentMonth=11,this.currentYear--):this.currentMonth--)},nextMonth(){this.isMaxMonth||(11===this.currentMonth?(this.currentMonth=0,this.currentYear++):this.currentMonth++)},blurInput(){this.isInputFocused&&this.$refs.noteInput.blur()},onBlur(){this.isInputFocused=!1}},watch:{note(){}}},H=(0,d.A)(q,[["render",z],["__scopeId","data-v-d0d29410"]]),Z=H,ee={name:"App",components:{LoadingScreen:h,EmotionSelect:Y,MainScreen:B,CalendarScreen:Z},data(){return{currentScreen:"loading",selectedEmotion:null,showSettings:!1}},methods:{handleEmotionSelect(e){this.selectedEmotion=e,this.currentScreen="main"},openSettings(){this.showSettings=!0},openCalendar(){this.currentScreen="calendar"},backToMain(){this.currentScreen="main"}},mounted(){setTimeout((()=>{this.currentScreen="emotion"}),2e3)}},ne=(0,d.A)(ee,[["render",s]]),te=ne;(0,r.Ef)(te).mount("#app")}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.m=e,(()=>{var e=[];t.O=(n,r,o,a)=>{if(!r){var s=1/0;for(u=0;u<e.length;u++){for(var[r,o,a]=e[u],i=!0,c=0;c<r.length;c++)(!1&a||s>=a)&&Object.keys(t.O).every((e=>t.O[e](r[c])))?r.splice(c--,1):(i=!1,a<s&&(s=a));if(i){e.splice(u--,1);var l=o();void 0!==l&&(n=l)}}return n}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]}})(),(()=>{t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})}})(),(()=>{t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n)})(),(()=>{t.p="/test/"})(),(()=>{var e={524:0};t.O.j=n=>0===e[n];var n=(n,r)=>{var o,a,[s,i,c]=r,l=0;if(s.some((n=>0!==e[n]))){for(o in i)t.o(i,o)&&(t.m[o]=i[o]);if(c)var u=c(t)}for(n&&n(r);l<s.length;l++)a=s[l],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(u)},r=self["webpackChunkweb_novels"]=self["webpackChunkweb_novels"]||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))})();var r=t.O(void 0,[504],(()=>t(847)));r=t.O(r)})();
//# sourceMappingURL=app.d1140cf2.js.map