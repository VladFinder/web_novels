(()=>{"use strict";var e={253:(e,n,t)=>{e.exports=t.p+"img/Раздражение.800c2a94.png"},428:(e,n,t)=>{var r=t(751),o=t(641);const a={id:"app"};function s(e,n,t,r,s,i){const c=(0,o.g2)("LoadingScreen"),l=(0,o.g2)("EmotionSelect"),u=(0,o.g2)("MainScreen"),d=(0,o.g2)("CalendarScreen");return(0,o.uX)(),(0,o.CE)("div",a,["loading"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(c,{key:0})):"emotion"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(l,{key:1,onEmotionSelected:i.handleEmotionSelect},null,8,["onEmotionSelected"])):"main"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(u,{key:2,onOpenSettings:i.openSettings,onOpenCalendar:i.openCalendar},null,8,["onOpenSettings","onOpenCalendar"])):"calendar"===s.currentScreen?((0,o.uX)(),(0,o.Wv)(d,{key:3,onBack:i.backToMain},null,8,["onBack"])):(0,o.Q3)("",!0)])}const i=t.p+"img/logo.2ea0a334.png",c={class:"loading-screen"};function l(e,n,t,r,a,s){return(0,o.uX)(),(0,o.CE)("div",c,n[0]||(n[0]=[(0,o.Lk)("div",{class:"loading-content"},[(0,o.Lk)("img",{src:i,alt:"Logo",class:"logo"}),(0,o.Lk)("p",{class:"loading-text"},"Загрузка...")],-1)]))}const u={name:"LoadingScreen"};var d=t(262);const h=(0,d.A)(u,[["render",l],["__scopeId","data-v-0864ef82"]]),m=h;var p=t(33);const g={class:"emotion-select"},v={class:"glass-container"},k={class:"emotions-grid"},b=["onClick"],f=["src","alt"],y={class:"emotion-name"};function M(e,n,t,r,a,s){return(0,o.uX)(),(0,o.CE)("div",g,[n[0]||(n[0]=(0,o.Lk)("h1",{class:"title"},"Как ты себя чувствуешь?",-1)),(0,o.Lk)("div",v,[(0,o.Lk)("div",k,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.emotions,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"emotion-item",onClick:n=>s.selectEmotion(e.id)},[(0,o.Lk)("img",{src:e.icon,alt:e.name},null,8,f),(0,o.Lk)("span",y,(0,p.v_)(e.name),1)],8,b)))),128))])])])}const S="https://ikiteam.ru/api",w={async saveUser(e){try{const n=await fetch(`${S}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:e})});return n.json()}catch(n){throw console.error("Error saving user:",n),n}},async saveEmotion(e,n){try{const t=await fetch(`${S}/emotions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telegramId:e,emotion:n.emotion,timestamp:n.timestamp})});return t.json()}catch(t){throw console.error("Error saving emotion:",t),t}},async getUserEmotions(e,n,t){try{const r=await fetch(`${S}/emotions?telegramId=${e}&startDate=${n}&endDate=${t}`);return r.json()}catch(r){throw console.error("Error getting emotions:",r),r}},async getUser(e){const n=await fetch(`${S}/users/${e}`);if(!n.ok)throw new Error("User not found");return await n.json()}},C=window.Telegram?.WebApp,E=()=>C?.initDataUnsafe?.user?.id,L={name:"EmotionSelect",data(){return{telegramId:null,emotions:[{id:1,name:"Радостно",icon:t(562)},{id:2,name:"Грустно",icon:t(644)},{id:3,name:"Спокойно",icon:t(693)},{id:4,name:"Тревожно",icon:t(485)},{id:5,name:"Раздражённо",icon:t(253)},{id:6,name:"Мечтательно",icon:t(815)}]}},mounted(){this.telegramId=E(),this.telegramId||console.warn("Telegram ID not found")},methods:{async selectEmotion(e){try{this.$emit("emotion-selected",e)}catch(n){console.error("Failed to save emotion:",n)}}}},I=(0,d.A)(L,[["render",M],["__scopeId","data-v-3263c592"]]),O=I,x=t.p+"img/soul.f8a4fa77.png",X={class:"main-screen"},_={key:0,class:"user-login"},D={class:"buttons-row"};function Y(e,n,t,r,a,s){return(0,o.uX)(),(0,o.CE)("div",X,[a.username?((0,o.uX)(),(0,o.CE)("div",_," Привет, @"+(0,p.v_)(a.username)+"! ",1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{class:"settings-btn",onClick:n[0]||(n[0]=n=>e.$emit("open-settings"))}),n[3]||(n[3]=(0,o.Lk)("div",{class:"glass-container"},[(0,o.Lk)("span",{class:"soul-text"},[(0,o.eW)(" Ты не ты, когда"),(0,o.Lk)("br"),(0,o.eW)("голоден ")])],-1)),n[4]||(n[4]=(0,o.Lk)("div",{class:"soul-image"},[(0,o.Lk)("img",{src:x,alt:"Soul"})],-1)),(0,o.Lk)("div",D,[(0,o.Lk)("button",{class:"btn calendar",onClick:n[1]||(n[1]=n=>e.$emit("open-calendar"))}," Календарь настроения "),n[2]||(n[2]=(0,o.Lk)("button",{class:"btn stories",disabled:""}," Скоро тут будут истории ",-1))])])}const $={name:"MainScreen",data(){return{username:null}},async mounted(){const e=E();if(e)try{const n=await w.getUser(e);n&&n.login&&(this.username=n.login)}catch(n){console.error("Ошибка получения логина:",n)}}},j=(0,d.A)($,[["render",Y],["__scopeId","data-v-5a4b4d91"]]),F=j,T={class:"calendar-header"},A=["disabled"],W={class:"month-title"},U=["disabled"],B={class:"calendar-grid"};function K(e,n,t,a,s,i){return(0,o.uX)(),(0,o.CE)("div",{class:"calendar-screen",onClick:n[6]||(n[6]=(...e)=>i.blurInput&&i.blurInput(...e))},[(0,o.Lk)("button",{class:"back-btn",onClick:n[0]||(n[0]=n=>e.$emit("back"))},"Назад"),(0,o.Lk)("div",T,[(0,o.Lk)("button",{class:"nav-btn",onClick:n[1]||(n[1]=(...e)=>i.prevMonth&&i.prevMonth(...e)),disabled:i.isMinMonth},"<",8,A),(0,o.Lk)("span",W,(0,p.v_)(i.monthName)+" "+(0,p.v_)(s.currentYear),1),(0,o.Lk)("button",{class:"nav-btn",onClick:n[2]||(n[2]=(...e)=>i.nextMonth&&i.nextMonth(...e)),disabled:i.isMaxMonth},">",8,U)]),(0,o.Lk)("div",B,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.weekDays,(e=>((0,o.uX)(),(0,o.CE)("div",{class:"calendar-day calendar-day-header",key:e},(0,p.v_)(e),1)))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.firstDayOfWeek,(e=>((0,o.uX)(),(0,o.CE)("div",{key:"empty-"+e,class:"calendar-day empty"})))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.daysInMonth,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"calendar-day"},(0,p.v_)(e),1)))),128))]),(0,o.Lk)("div",{class:"note-container",onClick:n[5]||(n[5]=(0,r.D$)((()=>{}),["stop"]))},[(0,o.bo)((0,o.Lk)("textarea",{class:"note-input","onUpdate:modelValue":n[3]||(n[3]=e=>s.note=e),placeholder:"Напишешь пару слов о сегодняшнем дне?",rows:"3",ref:"noteInput",onBlur:n[4]||(n[4]=(...e)=>i.onBlur&&i.onBlur(...e))},null,544),[[r.Jo,s.note]])])])}const N=2025,P=5,J=1,Q={name:"CalendarScreen",data(){const e=new Date,n=P,t=N,r=e.getMonth(),o=e.getFullYear();return{currentMonth:r,currentYear:o,minMonth:n,minYear:t,weekDays:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],note:"",isInputFocused:!1}},computed:{monthName(){return["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"][this.currentMonth]},daysInMonth(){const e=new Date(this.currentYear,this.currentMonth+1,0).getDate();return this.currentYear===N&&this.currentMonth===P?Array.from({length:e-J+1},((e,n)=>n+J)):Array.from({length:e},((e,n)=>n+1))},firstDayOfWeek(){let e=new Date(this.currentYear,this.currentMonth,this.currentYear===N&&this.currentMonth===P?J:1).getDay();return e=(e+6)%7,e},isMinMonth(){return this.currentYear===this.minYear&&this.currentMonth===this.minMonth},isMaxMonth(){const e=new Date;return this.currentYear===e.getFullYear()&&this.currentMonth===e.getMonth()}},methods:{prevMonth(){this.isMinMonth||(0===this.currentMonth?(this.currentMonth=11,this.currentYear--):this.currentMonth--)},nextMonth(){this.isMaxMonth||(11===this.currentMonth?(this.currentMonth=0,this.currentYear++):this.currentMonth++)},blurInput(){this.isInputFocused&&this.$refs.noteInput.blur()},onBlur(){this.isInputFocused=!1}},watch:{note(){}}},V=(0,d.A)(Q,[["render",K],["__scopeId","data-v-d0d29410"]]),q=V,z={name:"App",components:{LoadingScreen:m,EmotionSelect:O,MainScreen:F,CalendarScreen:q},data(){return{currentScreen:"loading",selectedEmotion:null,showSettings:!1}},methods:{handleEmotionSelect(e){this.selectedEmotion=e,this.currentScreen="main"},openSettings(){this.showSettings=!0},openCalendar(){this.currentScreen="calendar"},backToMain(){this.currentScreen="main"}},mounted(){setTimeout((()=>{this.currentScreen="emotion"}),2e3)}},G=(0,d.A)(z,[["render",s]]),H=G;(0,r.Ef)(H).mount("#app")},485:(e,n,t)=>{e.exports=t.p+"img/Тревога.cb2b7443.png"},562:(e,n,t)=>{e.exports=t.p+"img/Радость.225d89ef.png"},644:(e,n,t)=>{e.exports=t.p+"img/Грусть.cba9a168.png"},693:(e,n,t)=>{e.exports=t.p+"img/Спокойно.b1a2b402.png"},815:(e,n,t)=>{e.exports=t.p+"img/Мечтательность.a6e023e0.png"}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.m=e,(()=>{var e=[];t.O=(n,r,o,a)=>{if(!r){var s=1/0;for(u=0;u<e.length;u++){for(var[r,o,a]=e[u],i=!0,c=0;c<r.length;c++)(!1&a||s>=a)&&Object.keys(t.O).every((e=>t.O[e](r[c])))?r.splice(c--,1):(i=!1,a<s&&(s=a));if(i){e.splice(u--,1);var l=o();void 0!==l&&(n=l)}}return n}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]}})(),(()=>{t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})}})(),(()=>{t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n)})(),(()=>{t.p="/test/"})(),(()=>{var e={524:0};t.O.j=n=>0===e[n];var n=(n,r)=>{var o,a,[s,i,c]=r,l=0;if(s.some((n=>0!==e[n]))){for(o in i)t.o(i,o)&&(t.m[o]=i[o]);if(c)var u=c(t)}for(n&&n(r);l<s.length;l++)a=s[l],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(u)},r=self["webpackChunkweb_novels"]=self["webpackChunkweb_novels"]||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))})();var r=t.O(void 0,[504],(()=>t(428)));r=t.O(r)})();
//# sourceMappingURL=app.229da81b.js.map